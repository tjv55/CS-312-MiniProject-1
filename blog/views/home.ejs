<%- include('partials/header') %>

<div class="container mt-5">
  <h1 class="mb-4">Blah</h1>
  <p>Welcome to Blahman's blog, add a post below please.</p>

  <!-- Blog Posts List -->
  <h2 class="mb-3">Blog Posts</h2>

  <% posts.forEach(post => { %>
    <div class="card mb-4">
      <div class="card-body">
        <h3 class="card-title"><%= post.title %></h3>
        <p class="post-meta"><strong>by</strong> <%= post.author %> â€” <%= post.createdAt %></p>
        <p><strong>Category:</strong> <%= post.category %></p>
        <p><%= post.content.length > 200 ? post.content.substring(0, 200) + '...' : post.content %></p>

        <a href="/post/<%= post.id %>" class="btn btn-outline-primary btn-sm">Read More</a>
        <a href="/edit/<%= post.id %>" class="btn btn-outline-secondary btn-sm">Edit</a>
        <form action="/delete/<%= post.id %>" method="POST" class="d-inline" onsubmit="return confirm('Are you sure you want to delete this post?');">
          <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
        </form>
      </div>
    </div>
  <% }) %>

  <!-- Compose Form -->
  <div class="card mb-5">
    <div class="card-body">
      <h4 class="card-title">Create New Post</h4>
      <form action="/compose" method="POST">
        <div class="mb-3">
          <label for="title" class="form-label">Title:</label>
          <input type="text" class="form-control" name="title" required>
        </div>
        <div class="mb-3">
          <label for="author" class="form-label">Author:</label>
          <input type="text" class="form-control" name="author" required>
        </div>
        <div class="mb-3">
          <label for="category" class="form-label">Category:</label>
          <select class="form-select" name="category" required>
            <option value="">-- Select Category --</option>
            <option value="Tech">Tech</option>
            <option value="Lifestyle">Lifestyle</option>
            <option value="Education">Education</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="content" class="form-label">Content:</label>
          <textarea class="form-control" name="content" rows="5" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Publish Post</button>
      </form>
    </div>
  </div>


</div>

<%- include('partials/footer') %>